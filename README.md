# GANGAN-gashuku
GANをガンガンやる合宿
参考　： https://github.com/GANs-in-Action

# GPU用リモートサーバで計算を行いたい
## リモートサーバでの設定

参考1 ： [リモートサーバの Jupyter Notebook を SSH Port Forwarding 経由で使う](https://blog.amedama.jp/entry/jupyter-nb-ssh-port-forwarding)  
参考2 : [リモートサーバ上の Docker コンテナで Jupyter Notebook を使う](https://blog.amedama.jp/entry/2018/10/24/085703)  
参考3 : [sshポートフォワーディング](https://qiita.com/mechamogera/items/b1bb9130273deb9426f5)

```zsh
client $ ssh -L 8888:localhost:8888 <username>@<remotehost>
```

```
remote $ sudo docker container run --rm -p 127.0.0.1:8888:8888 -it mimata/jupyter
```

# GANと生成モデル
## 1.1 敵対的生成ネットワークとは何か？

敵対的生成ネットワーク（GAN: Generative Adversarial Networks）とは機械学習技術の一種で、同時に訓練される以下の２つのモデルからなる。

- 生成器(generator)：偽のデータを作成する
- 識別器(discriminator)：本物か偽物かデータを見分ける

生成器が面白くて、例えば著名な画家が書いたような絵を模造できる。  
敵対的(adversarial)という語は、GANを構成する２つのモデルである生成器と識別器がゲームのように競争的な動作をすることから来ている。

## 1.2 GANの訓練
GANの訓練アルゴリズムについて  
GANは識別器は訓練誤差を最小化し、うまく分類させようとする一方で、生成器は識別器を騙そうと、訓練誤差を最大化する方向に学習していく。
* * *

1. 識別器の訓練
    1. 訓練データからランダムに本物のサンプルxを取り出す
    1. 新しい乱数ベクトルzを生成し、生成器ネットワークを用いて偽のサンプルx'を生成
    1. 識別器ネットワークを使って前後さを誤差逆伝播させることで、識別器の訓練可能なパラメータを更新、分類誤差を最小化
    1. 分類誤差を計算し、全誤差を誤差逆伝播させる。識別器の訓練可能なパラメータを更新、`分類誤差を最小化`
1. 生成器の訓練
    1. 新しい乱数ベクトルzを生成し、生成器ネットワークを用いて偽のサンプルx'を生成
    1. 識別器ネットワークを用いてx'が本物か推定
    1. 分類誤差を計算し、誤差逆伝播させることにより、生成器ネットワークの訓練可能なパラメータを更新する。識別器の`誤差を最大化`

* * * 

## 1.3 均衡状態
さて、矛盾する欲求を満たそうとしているこの２つのモデルについて考察してみよう。識別器の性能がよくなれば、生成器の性能は悪くなる。生成器の性能がよくなれば、識別器の性能は悪くなる。つまりゼロサムゲームなのである。ゲーム理論的にこれを捉えると、ナッシュ均衡が定義できる。

- 生成器が訓練データの中にある本物のサンプルと見分けがつかない偽のサンプルを生成する
- 識別器は入力されたサンプルが本物かどうか、ランダムに推定することしかできなくなる。すなわち正答率が50%になる

識別器側から見たとき、もう見分けがつかないほど精巧な偽のサンプルを生成されてしまうと、当てずっぽうに適当な回答を行い確率的に当たる、外れるが生じる状態になってしまう。  
生成器側からこの状態を見てみると、自分をどう変更してもこれ以上の改善が見込めない状態に陥る  
つまり学習が収束しているのである。

# オートエンコーダを用いた生成モデル
GANより古い概念としてオートエンコーダがある。自分自身をよく表すモデルとして今でも事前学習などで頻繁に利用されるが、GANを理解する上でオートエンコーダを学ぶことは非常に有用である。
## オートエンコーダとGANの違い
オートエンコーダは１つの損失関数を使ってネットワーク全体を入力から出力まで一度に最適化するが、GANは生成器と識別器にそれぞれ異なった損失関数を割り当てる

# MNISTによる学習
LeakyReLUとは  
https://www.atmarkit.co.jp/ait/articles/2005/13/news009.html  
